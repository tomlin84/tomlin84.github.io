<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>[ Snmp ] 安裝與設定 for Centos</title>
    <url>/2021/09/01/20210901/</url>
    <content><![CDATA[<blockquote>
<p>紀錄要如何在Centos安裝與設定snmp 服務，以便於監控軟體後續的設定</p>
</blockquote>
<span id="more"></span>
<p>安裝 snmp套件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum -y install net-snmp net-snmp-utils</span><br></pre></td></tr></table></figure>

<p>編輯snmp設定檔</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/snmp/snmpd.conf</span><br></pre></td></tr></table></figure>

<!--more-->


<p>修改config</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">####</span></span><br><span class="line"><span class="comment"># First, map the community name &quot;public&quot; into a &quot;security name&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#       sec.name  source          community</span></span><br><span class="line">com2sec notConfigUser  default       public         //通關密碼</span><br><span class="line"></span><br><span class="line"><span class="comment">####</span></span><br><span class="line"><span class="comment"># Second, map the security name into a group name:</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#       groupName      securityModel securityName</span></span><br><span class="line">group   notConfigGroup v1           notConfigUser</span><br><span class="line">group   notConfigGroup v2c           notConfigUser</span><br><span class="line"></span><br><span class="line"><span class="comment">####</span></span><br><span class="line"><span class="comment"># Third, create a view for us to let the group have rights to:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Make at least  snmpwalk -v 1 localhost -c public system fast again.</span></span><br><span class="line"><span class="comment">#       name           incl/excl     subtree         mask(optional)</span></span><br><span class="line">view    systemview    included   .1.3.6.1.2.1.1</span><br><span class="line">view    systemview    included   .1.3.6.1.2.1.25.1.1</span><br><span class="line">view    systemview    included   .1                          //獲得所有的資訊</span><br><span class="line"></span><br><span class="line"><span class="comment">####</span></span><br><span class="line"><span class="comment"># Finally, grant the group read-only access to the systemview view.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#       group          context sec.model sec.level prefix read   write  notif</span></span><br><span class="line">access  notConfigGroup <span class="string">&quot;&quot;</span>      any       noauth    exact  systemview none none</span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------------------------------------------------------</span></span><br></pre></td></tr></table></figure>

<p>啟動snmp+預設開機啟動</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> snmpd.service</span><br><span class="line">systemctl restart snmpd.service</span><br></pre></td></tr></table></figure>

<p>防火牆放行udp161允許snmpd服務存取</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firewall-cmd --add-port=161/udp --permanent</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>設備監控</category>
      </categories>
      <tags>
        <tag>SNMP</tag>
      </tags>
  </entry>
  <entry>
    <title>[ Snmp ] 安裝與設定 for ESXI</title>
    <url>/2021/09/02/20210902/</url>
    <content><![CDATA[<blockquote>
<p>紀錄要如何在Esxi安裝與設定snmp 服務，以便於監控軟體後續的設定</p>
</blockquote>
<span id="more"></span>
<p>1.在esxi 上打開 ssh功能</p>
<p>2.以 ssh client 登入 ESXi shell</p>
<p>3.執行 snmp 相關設定</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">esxcli system snmp set -c public</span><br><span class="line">esxcli system snmp set -e yes</span><br></pre></td></tr></table></figure>
<ol start="4">
<li><p>退出 ESXi shell （記得要 logout ，因為 VMWare ESXi 的 Shell 不會因為關閉了 SSH 而強制被離線，會持續連線著…..個人覺得這是個漏洞）</p>
</li>
<li><p>以 vsphere client 登入 esxi 然後 關閉 SSH 服務</p>
</li>
<li><p>以 vsphere client 登入 esxi 然後 開啟 SNMP 服務</p>
</li>
</ol>
]]></content>
      <categories>
        <category>設備監控</category>
      </categories>
      <tags>
        <tag>SNMP</tag>
        <tag>Esxi</tag>
      </tags>
  </entry>
  <entry>
    <title>[ Snmp ] 安裝與設定 for Windows </title>
    <url>/2021/09/03/20210903/</url>
    <content><![CDATA[<blockquote>
<p>紀錄要如何在windows安裝與設定snmp 服務，以便於監控軟體後續的設定</p>
</blockquote>
<span id="more"></span>
<h3 id="伺服器管理員-gt-新增角色與功能-gt-功能-gt-安裝SNMP-Service"><a href="#伺服器管理員-gt-新增角色與功能-gt-功能-gt-安裝SNMP-Service" class="headerlink" title="伺服器管理員&gt;新增角色與功能&gt;功能&gt;安裝SNMP  Service"></a>伺服器管理員&gt;新增角色與功能&gt;功能&gt;安裝SNMP  Service</h3><img src="https://res.cloudinary.com/dkqqwoda5/image/upload/v1632070467/snmp-1_lm50ho.png" width="80%" />

<h3 id="安裝完成，前往”服務”設定-snmp-service"><a href="#安裝完成，前往”服務”設定-snmp-service" class="headerlink" title="安裝完成，前往”服務”設定  snmp service"></a>安裝完成，前往”服務”設定  snmp service</h3><p>  備註:安裝完不用重新開機，沒有看到這個服務代表安裝失敗</p>
<img src="https://res.cloudinary.com/dkqqwoda5/image/upload/v1632070757/snmp-2_hhmr34.png" width="80%" />

<h3 id="在安全性新增通關密碼與選擇所有主機接受snmp封包。"><a href="#在安全性新增通關密碼與選擇所有主機接受snmp封包。" class="headerlink" title="在安全性新增通關密碼與選擇所有主機接受snmp封包。"></a>在安全性新增通關密碼與選擇所有主機接受snmp封包。</h3><img src="https://res.cloudinary.com/dkqqwoda5/image/upload/v1632070877/snmp-3_o0gkmo.png" width="80%" />]]></content>
      <categories>
        <category>設備監控</category>
      </categories>
      <tags>
        <tag>SNMP</tag>
      </tags>
  </entry>
  <entry>
    <title>[ Cmd ] 檢查服務是否執行 </title>
    <url>/2021/09/04/20210904/</url>
    <content><![CDATA[<blockquote>
<p>紀錄如何使用cmd來檢查服務是否正常運作的排程</p>
</blockquote>
<span id="more"></span>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sc query <span class="string">&quot;服務名稱&quot;</span> | find <span class="string">&quot;RUNNING&quot;</span> &gt; nul</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;%ERRORLEVEL%&quot;</span>==<span class="string">&quot;1&quot;</span> (</span><br><span class="line">    call c:\TEST.bat  </span><br><span class="line">) <span class="keyword">else</span> (</span><br><span class="line">    <span class="built_in">echo</span> Program is not running</span><br><span class="line">)</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>

<p>TEST.bat -&gt; 呼叫服務啟動</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">set</span> nowtime= %date:~0,4%%date:~5,2%%date:~8,2%%time:~0,2%%time:~3,2% </span><br><span class="line">net start <span class="string">&quot;服務名稱&quot;</span></span><br><span class="line"><span class="built_in">echo</span> %nowtime% &gt;&gt;C:\log.txt  <span class="comment">#紀錄啟用這個指令的時間</span></span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>CMD</tag>
      </tags>
  </entry>
  <entry>
    <title>[ Cmd ] 使用指令登出、關機 </title>
    <url>/2021/09/05/20210905/</url>
    <content><![CDATA[<blockquote>
<p>紀錄常用的cmd的相關指令</p>
</blockquote>
<span id="more"></span>
<br>
登出
<br>
<br>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">logoff</span><br></pre></td></tr></table></figure>
<br>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shutdown -l</span><br></pre></td></tr></table></figure>
<br>
關機 會跳出視窗
<br>
<br>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">SHUTDOWN -r -T 30 -C <span class="string">&quot;你的電腦將在30秒後重啟&quot;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>CMD</tag>
      </tags>
  </entry>
  <entry>
    <title>[ Cmd ] 時間變數 </title>
    <url>/2021/09/06/20210906/</url>
    <content><![CDATA[<blockquote>
<p>紀錄cmd中時間變數</p>
</blockquote>
<span id="more"></span>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">%time:~0,2% -&gt;表示從左向右指標向右偏0位，然後從指標偏移到的位置開始提取2位字元，結果是小時欄位數值</span><br><span class="line">%time:~3,2% -&gt;表示指標從左向右偏移3位，然後從偏移處開始提取2位字元，結果是分鐘欄位數值</span><br><span class="line">%time:~6,2% -&gt;表示指標從左向右偏移6位，然後從偏移處開始提取2位字元，結果是秒欄位數值</span><br><span class="line"></span><br><span class="line">%date:~0,4% -&gt;表示從左向右指標向右偏0位，然後從指標偏移到的位置開始提取4位字元，結果是（年的值）</span><br><span class="line">%date:~5,2% -&gt;表示指標從左向右偏移5位，然後從偏移處開始提取2位字元，結果是（月的值）</span><br><span class="line">%date:~8,2% -&gt;表示指標從左向右偏移8位，然後從偏移處開始提取2位字元，結果是（日的值）</span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>CMD</tag>
      </tags>
  </entry>
  <entry>
    <title>[ Cmd ] 網路卡的 mac address 匯出</title>
    <url>/2021/09/07/20210908/</url>
    <content><![CDATA[<blockquote>
<p>紀錄如何使用Cmd匯出網卡的 mac 資訊</p>
</blockquote>
<span id="more"></span>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> /f <span class="string">&quot;tokens=1-7 delims=- &quot;</span> %%i <span class="keyword">in</span> (<span class="string">&#x27;getmac ^| find &quot;-&quot;&#x27;</span>) <span class="keyword">do</span> <span class="built_in">echo</span> %%i:%%j:%%k:%%l:%%m:%%n &gt;&gt;e:\mac.txt</span><br><span class="line">REM 匯出到E槽mac.txt 文件</span><br></pre></td></tr></table></figure>
<br>
備註:該指令會匯出電腦全部網卡的mac，依序排列
]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>CMD</tag>
      </tags>
  </entry>
  <entry>
    <title>[ Cmd ] Net user 使用方法 </title>
    <url>/2021/09/13/20210913/</url>
    <content><![CDATA[<blockquote>
<p>紀錄Cmd的 net user 使用方法</p>
</blockquote>
<span id="more"></span>

<p>net  user  是用來新增、 刪除、 異動使用者帳戶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">net user  </span><br><span class="line"><span class="comment">#查看系統所有帳號</span></span><br><span class="line">net user [帳號] </span><br><span class="line"><span class="comment">#查看系統帳號</span></span><br><span class="line">net user [帳號] [密碼] /add  </span><br><span class="line"><span class="comment">#新增帳號</span></span><br><span class="line">net user [帳號] [密碼] /del</span><br><span class="line"><span class="comment">#刪除 帳號</span></span><br><span class="line">net localgroup Administrators [帳號] /add </span><br><span class="line"><span class="comment">#加入administrator群組</span></span><br><span class="line">net localgroup Administrators [帳號] /del   </span><br><span class="line"><span class="comment">#從administrator群組移除</span></span><br><span class="line">net user  [帳號]  /active:yes </span><br><span class="line"><span class="comment">#啟用帳號</span></span><br><span class="line">net user  [帳號]  /active:no</span><br><span class="line"><span class="comment">#停用帳號</span></span><br><span class="line">net user [帳號] [密碼]</span><br><span class="line"><span class="comment">#修改帳號密碼， 不需要知道舊密碼 </span></span><br><span class="line">net user  [帳號] /passwordchange:yes</span><br><span class="line"><span class="comment">#用戶可以修改密碼 </span></span><br><span class="line">net user  [帳號] /passwordchange:no</span><br><span class="line"><span class="comment">#用戶不可以修改密碼 </span></span><br><span class="line">WMIC USERACCOUNT WHERE <span class="string">&quot;Name=&#x27;[帳號]&#x27;&quot;</span> SET PasswordExpires=FALSE </span><br><span class="line"><span class="comment">#設定密碼永不過期</span></span><br><span class="line">net user /domain</span><br><span class="line"><span class="comment">#查看網域內的所有帳號 </span></span><br><span class="line">net user [帳號] /domain</span><br><span class="line"><span class="comment">#查詢該網域帳號的資訊</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>CMD</tag>
      </tags>
  </entry>
  <entry>
    <title>[ Cmd ] 啟用金鑰 </title>
    <url>/2021/09/14/20210914/</url>
    <content><![CDATA[<blockquote>
<p>紀錄如何使用Cmd來安裝 windows 序號</p>
</blockquote>
<span id="more"></span>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">slmgr.vbs /upk    <span class="comment">#移除金鑰</span></span><br><span class="line">slmgr /ipk [金鑰] <span class="comment">#安裝產金鑰 ps:不要省略&quot;-&quot;</span></span><br><span class="line">slmgr /skms [金鑰伺服器] <span class="comment">#設定金鑰認證伺服器</span></span><br><span class="line">slmgr /ato <span class="comment">#成功啟用金鑰</span></span><br></pre></td></tr></table></figure>
<p>備註:一定要使用系統管理員身分執行+連上網路</p>
]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>CMD</tag>
      </tags>
  </entry>
  <entry>
    <title>[Network] mac 連接 switch console port</title>
    <url>/2021/09/20/20210920/</url>
    <content><![CDATA[<blockquote>
<p>紀錄如何使用mac來連接 switch console</p>
</blockquote>
<span id="more"></span>
<p>將 console 線接上mac<br>註:上色部分需要購買專用線材<br>[ switch console port →<font color=#0000FF> RJ45 →RS232 母 → RS232 公 → usb </font>→mac ] </p>
<p>使用 terminal 輸入下列指令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ls /dev/ | grep -i usb</span><br></pre></td></tr></table></figure>
<p>使用screen 指令連接 console</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">screen /dev/tty.usbserial-120 38400</span><br></pre></td></tr></table></figure>
<p>註:38400是為 HPE 1620S Switch 的 baud rate，每台設備都不一樣，務必要去參閱說明書<br><br><br>這樣就成功連接到 switch console 介面</p>
]]></content>
      <categories>
        <category>Network</category>
      </categories>
      <tags>
        <tag>switch</tag>
      </tags>
  </entry>
  <entry>
    <title> [系統部署] Gitlab 架設 </title>
    <url>/2021/09/21/20210921/</url>
    <content><![CDATA[<blockquote>
<p>紀錄如何安裝 Gitlab Server</p>
</blockquote>
<span id="more"></span>
<p>安裝ssh指令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo dnf install -y curl policycoreutils openssh-server</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> sshd</span><br><span class="line">sudo systemctl start sshd</span><br></pre></td></tr></table></figure>
<p>防火牆規則開通</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo firewall-cmd --permanent --add-service=http</span><br><span class="line">sudo firewall-cmd --permanent --add-service=https</span><br><span class="line">sudo systemctl reload firewalld</span><br></pre></td></tr></table></figure>
<p>寄信套件安裝</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo dnf install postfix</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> postfix</span><br><span class="line">sudo systemctl start postfix</span><br></pre></td></tr></table></figure>
<p>安裝gitlab<br>備註:可以直接安裝EE(企業版)版本的，在沒有註冊的狀況下功能會被限縮等同於CE(社群版)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh | sudo bash</span><br><span class="line">sudo EXTERNAL_URL=<span class="string">&quot;https://gitlab.example.com&quot;</span> dnf install -y gitlab-ee</span><br></pre></td></tr></table></figure>

<p>安裝完成後，要去修改gitlab.rb內容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/gitlab/gitlab.rb</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.(第十五行)</span><br><span class="line">external_url <span class="string">&#x27;https://gitlab.example.com&#x27;</span>  (改成你要的網址)</span><br><span class="line">external_url <span class="string">&#x27;http://1.1.1.1:8888&#x27;</span>         (改成ip)</span><br></pre></td></tr></table></figure>
<p>參考資料</p>
<ul>
<li><a href="https://docs.gitlab.com/ee/install/">https://docs.gitlab.com/ee/install/</a></li>
</ul>
]]></content>
      <categories>
        <category>系統部署</category>
        <category>Gitlab</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title> [系統部署] 使用 AD 帳號登入 Gitlab </title>
    <url>/2021/09/23/20210923/</url>
    <content><![CDATA[<blockquote>
<p>紀錄如何使用 AD 帳號來登入 Gitlab Server</p>
</blockquote>
<span id="more"></span>
<blockquote>
<p>CN屬性</p>
</blockquote>
<table>
<thead>
<tr>
<th>屬性名稱</th>
<th align="center">全名</th>
<th align="right">說明</th>
</tr>
</thead>
<tbody><tr>
<td>CN</td>
<td align="center">Common Name</td>
<td align="right">用戶名稱、單位名稱</td>
</tr>
<tr>
<td>DN</td>
<td align="center">Distinguished Name</td>
<td align="right">識別名稱，絕對位置</td>
</tr>
<tr>
<td>OU</td>
<td align="center">Organizational Unit Name</td>
<td align="right">組織單位名稱</td>
</tr>
<tr>
<td>DC</td>
<td align="center">Domain Componet</td>
<td align="right">網域元件</td>
</tr>
</tbody></table>
<blockquote>
<p>設定方法</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gitlab_rails[<span class="string">&#x27;ldap_enabled&#x27;</span>] = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###! **remember to close this block with &#x27;EOS&#x27; below**</span></span><br><span class="line">gitlab_rails[<span class="string">&#x27;ldap_servers&#x27;</span>] = YAML.load &lt;&lt;-<span class="string">&#x27;EOS&#x27;</span></span><br><span class="line">   main: <span class="comment"># &#x27;main&#x27; is the GitLab &#x27;provider ID&#x27; of this LDAP server</span></span><br><span class="line">     label: <span class="string">&#x27;LDAP&#x27;</span></span><br><span class="line">     host: <span class="string">&#x27;IP&#x27;</span></span><br><span class="line">     port: 389</span><br><span class="line">     uid: <span class="string">&#x27;sAMAccountName&#x27;</span></span><br><span class="line">     bind_dn: <span class="string">&#x27;CN=Administrator,CN=Users,DC=test,DC=com&#x27;</span></span><br><span class="line">     password: <span class="string">&#x27;password&#x27;</span></span><br><span class="line">     encryption: <span class="string">&#x27;plain&#x27;</span> <span class="comment"># &quot;start_tls&quot; or &quot;simple_tls&quot; or &quot;plain&quot;</span></span><br><span class="line">     verify_certificates: <span class="literal">true</span></span><br><span class="line">     smartcard_auth: <span class="literal">false</span></span><br><span class="line">     active_directory: <span class="literal">true</span> </span><br><span class="line">     allow_username_or_email_login: <span class="literal">false</span> <span class="comment">#可以讓使用者使用 名稱 或 email 帳號登入</span></span><br><span class="line">     lowercase_usernames: <span class="literal">true</span></span><br><span class="line">     block_auto_created_users: <span class="literal">true</span>  <span class="comment"># 如果 true ，就會讓第一次登入的</span></span><br><span class="line">                                     <span class="comment"># 使用者看到 Your account is blocked.</span></span><br><span class="line">                                     <span class="comment"># Retry when an admin has unblocked it.</span></span><br><span class="line">                                     <span class="comment"># 它需要管理者解除才行</span></span><br><span class="line">     base: <span class="string">&#x27;OU=PRD,OU=TW,DC=test,DC=com &#x27;</span></span><br><span class="line">EOS</span><br></pre></td></tr></table></figure>
<p>ps:設定的帳號只需要一般的user權限，不需要很高的權限</p>
<blockquote>
<p>設定與LDAP同步時間 預設為早上1點30分</p>
</blockquote>
 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/etc/gitlab/gitlab.rb  </span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">gitlab_rails[<span class="string">&#x27;ldap_sync_worker_cron&#x27;</span>] = <span class="string">&quot;0 */12(2) * * *&quot;</span></span><br></pre></td></tr></table></figure>

 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">config/gitlab.yaml</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">cron_jobs: </span><br><span class="line">ldap_sync_worker_cron</span><br><span class="line">: <span class="string">&quot;0 */12(30) * * *&quot;</span></span><br></pre></td></tr></table></figure>

<p>  參考資料<br>  <a href="https://docs.gitlab.com/ee/administration/auth/ldap-ee.html">https://docs.gitlab.com/ee/administration/auth/ldap-ee.html</a></p>
]]></content>
      <categories>
        <category>系統部署</category>
        <category>Gitlab</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title> [系統部署]  Gitlab 常用指令 </title>
    <url>/2021/10/03/20211003/</url>
    <content><![CDATA[<blockquote>
<p>紀錄Gitlab Server 常用的指令</p>
</blockquote>
<span id="more"></span>
<p>重製設定</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gitlab-ctl reconfigure</span><br></pre></td></tr></table></figure>
<p>啟動</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gitlab-ctl start</span><br></pre></td></tr></table></figure>
<p>關閉</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gitlab-ctl stop</span><br></pre></td></tr></table></figure>
<p>升級</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum update gitlab-ee</span><br></pre></td></tr></table></figure>
<p>升級12版最新版號</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum update gitlab-ee</span><br></pre></td></tr></table></figure>
<p>手動備份</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gitlab-rake gitlab:backup:create</span><br></pre></td></tr></table></figure>
<p>要自行手動備份</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/etc/gitlab/gitlab.rb         <span class="comment">#配置文件須備份</span></span><br><span class="line">/var/opt/gitlab/nginx/conf    <span class="comment">#nginx配置文件</span></span><br><span class="line">/etc/postfix/main.cfpostfix   <span class="comment">#郵件配置備份</span></span><br></pre></td></tr></table></figure>
<p>更換備份資料夾[刷新檔案權限為git]</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir -p /mnt/gitlab/backups</span><br><span class="line">chown -R git.git /mnt/gitlab/backups</span><br><span class="line">chown -R git.git /mnt/gitlab/backups</span><br></pre></td></tr></table></figure>
<p>還原</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gitlab-ctl stop unicorn</span><br><span class="line">gitlab-ctl stop sidekiq</span><br><span class="line">gitlab-ctl status</span><br><span class="line"></span><br><span class="line">gitlab-rake gitlab:backup:restore backup=1525801521_gitlab_backup.tar(看檔案名稱)(還原最後一版可以不加這段</span><br><span class="line">gitlab:backup:restore backup=1525801521_gitlab_backup.tar(看檔案名稱)</span><br><span class="line"></span><br><span class="line">gitlab-ctl start</span><br></pre></td></tr></table></figure>

<p>502錯誤排解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/gitlab/gitlab.rb</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">unicorn[<span class="string">&#x27;port&#x27;</span>] = 9090(更換端口)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>系統部署</category>
        <category>Gitlab</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>[ Cmd ] 遠端桌面指令 </title>
    <url>/2021/10/04/20211004/</url>
    <content><![CDATA[<blockquote>
<p>紀錄如何使用cmd直接遠端桌面(跳過輸入帳密的地方)</p>
</blockquote>
<span id="more"></span>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cmdkey /generic:TERMSRV/IP /user:遠端帳號 /pass:遠端密碼 &amp;&amp; mstsc /admin /v:IP </span><br></pre></td></tr></table></figure>

<p>查詢遠端的憑證</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cmdkey /list</span><br></pre></td></tr></table></figure>

<p>刪除憑證</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#刪除一台的憑證</span></span><br><span class="line">ccmdkey /delete:[IP]</span><br><span class="line"><span class="comment">#刪除全部的憑證</span></span><br><span class="line">cmdkey /delete:target</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>CMD</tag>
      </tags>
  </entry>
  <entry>
    <title>[ cmd ] 使用指令刪除過期的檔案</title>
    <url>/2021/11/23/20211124/</url>
    <content><![CDATA[<blockquote>
<p>紀錄如何使用forfiles指令來進行群找&amp;刪除過期的檔案</p>
</blockquote>
]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Cmd</tag>
        <tag>log</tag>
      </tags>
  </entry>
  <entry>
    <title>[ PowerShell] Send-MailMessage 命令 </title>
    <url>/2021/11/23/20211123/</url>
    <content><![CDATA[<blockquote>
<p>紀錄如何使用PowerShell 寄信</p>
</blockquote>
<span id="more"></span>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$SmtpUser</span> = <span class="string">&#x27;username@outlook.com&#x27;</span></span><br><span class="line"><span class="variable">$smtpPassword</span> = <span class="string">&#x27;password&#x27;</span></span><br><span class="line"><span class="variable">$MailtTo</span> = <span class="string">&#x27;user@domain.com&#x27;</span></span><br><span class="line"><span class="variable">$MailFrom</span> = <span class="string">&#x27;username@outlook.com&#x27;</span></span><br><span class="line"><span class="variable">$MailSubject</span> = <span class="string">&quot;Test using <span class="variable">$SmtpServer</span>&quot;</span> </span><br><span class="line"><span class="variable">$port</span>=<span class="string">&#x27;25&#x27;</span> <span class="comment">## or 465</span></span><br><span class="line"><span class="variable">$Credentials</span> = New-Object System.Management.Automation.PSCredential -ArgumentList <span class="variable">$SmtpUser</span>, $(<span class="variable">$smtpPassword</span> | ConvertTo-SecureString -AsPlainText -Force) </span><br><span class="line">Send-MailMessage -To <span class="string">&quot;<span class="variable">$MailtTo</span>&quot;</span> -from <span class="string">&quot;<span class="variable">$MailFrom</span>&quot;</span> -Subject <span class="variable">$MailSubject</span> -SmtpServer <span class="variable">$SmtpServer</span> -UseSsl -Credential <span class="variable">$Credentials</span> -Port <span class="variable">$port</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>PowerShell</tag>
        <tag>通知</tag>
      </tags>
  </entry>
  <entry>
    <title>[ Cmd ] Net use 使用方法 </title>
    <url>/2021/12/04/20211204/</url>
    <content><![CDATA[<blockquote>
<p>紀錄 net use 在 cmd 的使用方法 </p>
</blockquote>
<span id="more"></span>

<p>net  use  是用來掛載、 刪除網路磁碟機或是建立ipc$連線</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">net use</span><br><span class="line"><span class="comment">#查看目前的遠端連線 </span></span><br><span class="line">net use \\ip\c$ [密碼]  /user:[帳號]</span><br><span class="line"><span class="comment">#直接登錄到對方的C槽 </span></span><br><span class="line">net use h: \\ip\c$ [密碼]  /user:[帳號]</span><br><span class="line"><span class="comment">#掛載對方的C 槽 再本機的 H槽 </span></span><br><span class="line">net use * /d /y</span><br><span class="line"><span class="comment">#刪除所有掛載的連線 </span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>CMD</tag>
      </tags>
  </entry>
  <entry>
    <title>[ Cmd ] sc 使用方法 </title>
    <url>/2021/12/05/20211205/</url>
    <content><![CDATA[<blockquote>
<p>紀錄 sc 在 cmd 的使用方法 </p>
</blockquote>
<span id="more"></span>

<p>SC (Service Control 的縮寫 ) 是用來查詢、啟動、停止，甚至刪除服務的指令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sc query</span><br><span class="line"><span class="comment">#檢視目前所有的服務狀態</span></span><br><span class="line">sc query [服務]</span><br><span class="line"><span class="comment">#檢視某服務的狀態 </span></span><br><span class="line">sc qc [服務]</span><br><span class="line"> <span class="comment">#檢視某服務的設定資訊</span></span><br><span class="line"> sc start [服務]</span><br><span class="line"> <span class="comment">#啟動某服務</span></span><br><span class="line"> sc stop [服務]</span><br><span class="line"> <span class="comment">#關閉某服務</span></span><br><span class="line"> sc delete [服務]</span><br><span class="line"> <span class="comment">#刪除某服務</span></span><br><span class="line"> sc config [服務]名 start = auto|demand|disabled</span><br><span class="line"> <span class="comment">#修改某服務的啟動類型</span></span><br><span class="line"> <span class="comment">#demand=手動 </span></span><br><span class="line"> <span class="comment">#disabled=禁用</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>CMD</tag>
      </tags>
  </entry>
  <entry>
    <title>[ Liunx ] 如何使用gnome shell Extensions </title>
    <url>/2021/12/12/20211212/</url>
    <content><![CDATA[<blockquote>
<p>簡單說明gnome shell Extensions  是什麼與要如何使用</p>
</blockquote>
<span id="more"></span>

<h4 id="gnome-shell-Extensions-是什麼"><a href="#gnome-shell-Extensions-是什麼" class="headerlink" title="gnome shell Extensions 是什麼?"></a>gnome shell Extensions 是什麼?</h4><p>簡單來說它就是 gnome shell 的擴充程式，來強化gnome 桌面的功能</p>
<p>類似瀏覽器的插件。例如:你可以在瀏覽器安裝附件來下載影片。這個附件是由第三方開發人員。<br>隨然web瀏覽器預設不提供，但是透過安裝附件可以強化瀏覽器的功能</p>
<h4 id="要如何安裝gnome-shell-Extensions"><a href="#要如何安裝gnome-shell-Extensions" class="headerlink" title="要如何安裝gnome shell Extensions"></a>要如何安裝gnome shell Extensions</h4><p>已經知道 gnome shell Extensions 是什麼了，那我們該如何安裝呢?<br>有三種方法可以安裝gnome Extensions </p>
<ul>
<li>使用liunx發行版本的安裝包</li>
<li>在瀏覽器查找並安裝擴充程式</li>
<li>下載並手動安裝擴充程式</li>
</ul>
<p>在安裝 gnome shell 擴充程式前 ，要先安裝 gnome tweak tool</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install gnome-tweak-tool</span><br></pre></td></tr></table></figure>
<p>有些擴充程式會有版本得限制，可以透過下面指令來知道目前的版本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gnome-shell --version</span><br></pre></td></tr></table></figure>

<h4 id="使用gnome-shell-extensins-安裝包-最簡單的方法"><a href="#使用gnome-shell-extensins-安裝包-最簡單的方法" class="headerlink" title="使用gnome-shell -extensins 安裝包 (最簡單的方法)"></a>使用gnome-shell -extensins 安裝包 (最簡單的方法)</h4><p>Liunx發行版(例如:ubuntu.Fedora)有提供一組安裝包，這個安裝版是有經過測試的，不需要擔心兼容性等問題</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install-shell-extensins</span><br></pre></td></tr></table></figure>

<p>你需要重新啟動系統，看到開始功能表“調教”，就會發現已經幫你自動安裝一些擴充程式了。 </p>
<h6 id="ps-這個翻譯真奇怪"><a href="#ps-這個翻譯真奇怪" class="headerlink" title="ps:這個翻譯真奇怪"></a>ps:這個翻譯真奇怪</h6><p>&lt;圖片&gt;</p>
]]></content>
      <categories>
        <category>Liunx</category>
      </categories>
  </entry>
  <entry>
    <title>[ Cmd ] 關於 net use 與  sc 差異 </title>
    <url>/2021/12/06/20211206/</url>
    <content><![CDATA[<blockquote>
<p>net use 與 sc 的指令都可以管理服務， 那究竟有什麼差異 ? </p>
</blockquote>
<span id="more"></span>

<p>以下為net use 與 sc 的指令的差異整理<br>&nbsp;</p>
<table>
<thead>
<tr>
<th></th>
<th align="center">Net Use</th>
<th align="center">sc</th>
</tr>
</thead>
<tbody><tr>
<td>最早出現的時代</td>
<td align="center">MS-Dos</td>
<td align="center">Windows NT</td>
</tr>
<tr>
<td>功能</td>
<td align="center">啟動、 停止、 暫停</td>
<td align="center">查詢狀態、新增刪除、更改配置與安全性</td>
</tr>
<tr>
<td>是否可以透過網路操作</td>
<td align="center">不行</td>
<td align="center">可以</td>
</tr>
<tr>
<td>服務的值</td>
<td align="center">顯示名稱、 服務名稱</td>
<td align="center">服務名稱</td>
</tr>
</tbody></table>
<p>&nbsp;<br>參考資料:<br><a href="https://superuser.com/questions/315166/">https://superuser.com/questions/315166/</a></p>
]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>CMD</tag>
      </tags>
  </entry>
  <entry>
    <title>[ Liunx ] Centos 8 時間問題</title>
    <url>/2021/12/13/20211213/</url>
    <content><![CDATA[<blockquote>
<p>簡單說明要如何修正 Centos 8 時間</p>
</blockquote>
<span id="more"></span>

<p> ps. 雖然Centos 8 2021/12/31 就停止更新了，但還是記錄一下當初是如何修正時間的問題 </p>
<p>Centos 上用了很久的NTP，在這次的升級的時候被放棄，由Chrony取代NTP</p>
<p>這邊會說要如何使用Chrony來設定Centos 時間</p>
<p>安裝套件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum install chrony</span><br></pre></td></tr></table></figure>

<p>安裝後啟動</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl start chronyd.service</span><br></pre></td></tr></table></figure>
<p>開機後自動啟動</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl enable chronyd.service</span><br></pre></td></tr></table></figure>

<p>設定檔修改</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vi /etc/chrony.conf</span><br></pre></td></tr></table></figure>
<p>預設裡面就有設定校時server ，是由centos 維護<br>如果想用台灣自己的校時server 可以改成</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">server tock.stdtime.gov.tw prefer</span><br><span class="line">server tick.stdtime.gov.tw</span><br><span class="line">server time.stdtime.gov.tw</span><br></pre></td></tr></table></figure>
<p>使用 chronyd 來檢查服務有沒有正常</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl status chronyd.service</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Liunx</category>
      </categories>
  </entry>
  <entry>
    <title>[ Snmp ] librenms 設定應用-badif</title>
    <url>/2022/01/01/20220101/</url>
    <content><![CDATA[<blockquote>
<p>好不容易把機器燈加入監控了，打開”ports”的頁面看到了一堆不相關的不相關的圖表，那要如何只保留自己想要看的圖表呢?這時候就是使用”badif”的時候了。</p>
</blockquote>
<span id="more"></span>
<p>修改設定檔</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /opt/librenms/config.php</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;allow_unauth_grahps&#x27;</span>] = 1;</span><br><span class="line"></span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;os&#x27;</span>][<span class="string">&#x27;windows&#x27;</span>][<span class="string">&#x27;bad_if&#x27;</span>][] = <span class="string">&#x27;WAN Miniport (PPTP).&#x27;</span>; </span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;os&#x27;</span>][<span class="string">&#x27;windows&#x27;</span>][<span class="string">&#x27;bad_if&#x27;</span>][] = <span class="string">&#x27;WAN Miniport (L2TP).&#x27;</span>; </span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;os&#x27;</span>][<span class="string">&#x27;windows&#x27;</span>][<span class="string">&#x27;bad_if&#x27;</span>][] = <span class="string">&#x27;WAN Miniport (IKEv2).&#x27;</span>; </span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;os&#x27;</span>][<span class="string">&#x27;windows&#x27;</span>][<span class="string">&#x27;bad_if&#x27;</span>][] = <span class="string">&#x27;WAN Miniport (GRE).&#x27;</span>; </span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;os&#x27;</span>][<span class="string">&#x27;windows&#x27;</span>][<span class="string">&#x27;bad_if&#x27;</span>][] = <span class="string">&#x27;WAN Miniport (SSTP).&#x27;</span>; </span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;os&#x27;</span>][<span class="string">&#x27;windows&#x27;</span>][<span class="string">&#x27;bad_if&#x27;</span>][] = <span class="string">&#x27;WAN Miniport (PPPOE).&#x27;</span>; </span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;os&#x27;</span>][<span class="string">&#x27;windows&#x27;</span>][<span class="string">&#x27;bad_if&#x27;</span>][] = <span class="string">&#x27;WAN Miniport (IPv6).&#x27;</span>; </span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;os&#x27;</span>][<span class="string">&#x27;windows&#x27;</span>][<span class="string">&#x27;bad_if&#x27;</span>][] = <span class="string">&#x27;WAN Miniport (Network Monitor).&#x27;</span>; </span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;os&#x27;</span>][<span class="string">&#x27;windows&#x27;</span>][<span class="string">&#x27;bad_if&#x27;</span>][] = <span class="string">&#x27;WAN Miniport (IP).&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>這些圖表就會被自動隱藏，就看不到了。</p>
<blockquote>
<p>每台機器所自動產生的網路圖表名稱，都會有所不同，可以使用下面指令去查詢，再進行設定</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">snmpwalk -c public -v 1 192.168.50.1 IfDescr</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>設備監控</category>
      </categories>
      <tags>
        <tag>SNMP</tag>
        <tag>librenms</tag>
      </tags>
  </entry>
  <entry>
    <title> [ Snmp ] librenms 設定應用-nagios </title>
    <url>/2022/12/05/20220103/</url>
    <content><![CDATA[<blockquote>
<p>librenms 有支援nagios Plugin 的擴充檢測功能，讓librenns有更強大的應用能力，在搭配上librenms的預警系統，可以快速知道問題發生，更迅速的處理。</p>
</blockquote>
<span id="more"></span>

<h3 id="安裝nagios套件"><a href="#安裝nagios套件" class="headerlink" title="安裝nagios套件"></a>安裝nagios套件</h3><p>安裝 EPEL 套件庫</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dnf install epel-release</span><br></pre></td></tr></table></figure>
<p>搜尋可以安裝的套件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dnf search nagios-plugins-</span><br></pre></td></tr></table></figure>
<p>下圖搜尋後的結果</p>
<img src="https://res.cloudinary.com/dkqqwoda5/image/upload/v1641395301/librenms_nagios_euhzml.png" width="80%" />

<p> [備註:nagios-plugins-mysql 會與maroadb互衝導致無法安裝]</p>
<h3 id="安裝套件-使用nagios-dns-示範"><a href="#安裝套件-使用nagios-dns-示範" class="headerlink" title="安裝套件 [使用nagios-dns 示範]"></a>安裝套件 [使用nagios-dns 示範]</h3><p>安裝指令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dnf install nagios-plugins-dns</span><br></pre></td></tr></table></figure>
<p>修改設定檔</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vim /opt/librenms/config.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># nagios-plugins-all</span><br><span class="line">$config[‘show_services’] = 1;</span><br><span class="line">$config[‘nagios_plugins’] = “/usr/lib64/nagios/plugins”;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod +x /usr/lib64/nagios/plugins/*</span><br></pre></td></tr></table></figure>
<p>設定排程</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vi /etc/cron.d/librenms</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">:</span><br><span class="line">*/5  *    * * *   librenms    /opt/librenms/services-wrapper.py 1</span><br><span class="line"># Daily maintenance script. DO NOT DISABLE!</span><br><span class="line">:</span><br></pre></td></tr></table></figure>


<p>重啟排程</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">service crond restart</span><br></pre></td></tr></table></figure>

<p>安裝設定完成，點擊首頁的service→add service，進入畫面進行設定。</p>
]]></content>
      <categories>
        <category>設備監控</category>
      </categories>
      <tags>
        <tag>SNMP</tag>
        <tag>librenms</tag>
      </tags>
  </entry>
</search>
